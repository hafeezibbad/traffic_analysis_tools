"""
Constants or regular expressions used in application.
"""

import os

STATICS_DIR_PATH = os.path.dirname(os.path.abspath(__file__))
IP_PROTOCOLS_DATA_FILE_PATH = os.path.join(STATICS_DIR_PATH, 'ip_protocol_data.json')
IP_OPTIONS_DATA_FILE_PATH = os.path.join(STATICS_DIR_PATH, 'ip_options_data.json')
ETHER_TYPES_DATA_FILE_PATH = os.path.join(STATICS_DIR_PATH, 'ethertype_data.json')
LAYER4_PORTS_DATA_FILE_PATH = os.path.join(STATICS_DIR_PATH, 'layer4_port_data.json')
TCP_FLAGS_DATA_FILE_PATH = os.path.join(STATICS_DIR_PATH, 'tcp_flags_data.json')
MANUF_DATA_FILE_PATH = os.path.join(STATICS_DIR_PATH, 'manuf')
IEEE80211_PROTOCOL_NUMBER = 34958
DATE_TIME_FORMAT = "%Y-%m-%d-%H-%M-%S"
EMAIL_REGEX = r'^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$'
MAC_REGEX = r'^([0-9A-F]{2}[:-]){5}([0-9A-F]{2})$'
NAME_REGEX = r'^[A-Za-z][A-Za-z0-9_.]*$'
FILENAME_REGEX = r'^[A-Za-z0-9\-_.]*.pcap_files$'
DEVICE_LIST_REGEX = r'^[A-Za-z0-9:,.]*$'
PROTOCOL_STATS = ["count", "last_ts", "total_data", "dpp", "iad"]
LAYER4_PROTOCOLS = ["tcp", "udp"]
WIRESHARK_MANUF_FILE = "https://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob_plain;f=manuf;hb=HEAD"
URL_REGEX = r'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
URL_WITHOUT_PROTOCOL = r'(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
IPv4_REGEX = r'^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.)' \
             r'{3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$'
# IPv6 Regex: https://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses
IPv6_REGEX = r'(' \
             '([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|'\
             '([0-9a-fA-F]{1,4}:){1,7}:|'\
             '([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|'\
             '([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|'\
             '([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|'\
             '([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|'\
             '([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|'\
             '[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|'\
             ':((:[0-9a-fA-F]{1,4}){1,7}|:)|'\
             'fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|'\
             '::(ffff(:0{1,4}){0,1}:){0,1}'\
             '((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}'\
             '(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|'\
             '([0-9a-fA-F]{1,4}:){1,4}:'\
             '((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}'\
             '(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])'\
             ')'
URI_REGEX = "^(?:([A-Za-z][A-Za-z0-9+\\-.]*):(?://((?:(?:(?:%[0-9A-Fa-f]{2}|" \
            "[!$&'()*+,;=A-Za-z0-9\\-._~])|:)*@)?(?:\\[(?:(?:(?:[0-9A-Fa-f]" \
            "{1,4}:){6}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9]" \
            "[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|" \
            "1[0-9]{2}|2[0-4][0-9]|25[0-5]))|::(?:[0-9A-Fa-f]{1,4}:){5}(?:" \
            "[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]" \
            "{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2" \
            "[0-4][0-9]|25[0-5]))|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}" \
            ":){4}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9]" \
            "[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]" \
            "|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]" \
            "{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]" \
            "{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)" \
            "{3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:(?:" \
            "[0-9A-Fa-f]{1,4}:){,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:)" \
            "{2}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|" \
            "1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]" \
            "{2}|2[0-4][0-9]|25[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:){,3}" \
            "[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:(?:[0-9A-Fa-f]{1,4}:" \
            "[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|" \
            "25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25" \
            "[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:){,4}[0-9A-Fa-f]{1,4})?::(?:" \
            "[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1" \
            "[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1" \
            "[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:){,5}" \
            "[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:)" \
            "{,6}[0-9A-Fa-f]{1,4})?::)(?:%25(?:[A-Za-z0-9\\-._~]|%" \
            "[0-9A-Fa-f]{2})+)?|[Vv][0-9A-Fa-f]+\\.(?:[!$&'()*+,;=" \
            "A-Za-z0-9\\-._~]|:)+)\\]|(?:%[0-9A-Fa-f]{2}|[!$&'()*+,;" \
            "=A-Za-z0-9\\-._~])*)(?::[0-9]*)?)((?:/(?:(?:%[0-9A-Fa-f]" \
            "{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])*)*)|(/(?:(?:(?:%" \
            "[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])+(?:/" \
            "(?:(?:%[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])*)*)?)|" \
            "((?:(?:%[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])+" \
            "(?:/(?:(?:%[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|" \
            "[:@])*)*)|())(?:\\?((?:(?:(?:%[0-9A-Fa-f]{2}|[!$&'()*+" \
            ",;=A-Za-z0-9\\-._~])|[:@])|[/?])*))?(?:#((?:(?:(?:%" \
            "[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])|[/?])*))?|" \
            "(?://((?:(?:(?:%[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|" \
            ":)*@)?(?:\\[(?:(?:(?:[0-9A-Fa-f]{1,4}:){6}(?:[0-9A-Fa-f]{1,4}:" \
            "[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|" \
            "25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|" \
            "25[0-5]))|::(?:[0-9A-Fa-f]{1,4}:){5}(?:[0-9A-Fa-f]{1,4}:" \
            "[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|" \
            "25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25" \
            "[0-5]))|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}(?:" \
            "[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]" \
            "{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2" \
            "[0-4][0-9]|25[0-5]))|(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4})?::" \
            "(?:[0-9A-Fa-f]{1,4}:){3}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|" \
            "(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}" \
            "(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:(?:" \
            "[0-9A-Fa-f]{1,4}:){,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:)" \
            "{2}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|" \
            "1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]" \
            "{2}|2[0-4][0-9]|25[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:){,3}" \
            "[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:(?:[0-9A-Fa-f]{1,4}:" \
            "[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4]" \
            "[0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4]" \
            "[0-9]|25[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:){,4}[0-9A-Fa-f]{1,4})" \
            "?::(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]" \
            "|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1" \
            "[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:){,5}" \
            "[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:)" \
            "{,6}[0-9A-Fa-f]{1,4})?::)(?:%25(?:[A-Za-z0-9\\-._~]|%" \
            "[0-9A-Fa-f]{2})+)?|[Vv][0-9A-Fa-f]+\\.(?:[!$&'()*+" \
            ",;=A-Za-z0-9\\-._~]|:)+)\\]|(?:%[0-9A-Fa-f]{2}|[!$&'()*+" \
            ",;=A-Za-z0-9\\-._~])*)(?::[0-9]*)?)((?:/(?:(?:%[0-9A-Fa-f]{2}|" \
            "[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])*)*)|(/(?:(?:(?:%[0-9A-Fa-f]" \
            "{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])+(?:/(?:(?:%[0-9A-Fa-f]" \
            "{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])*)*)?)|((?:(?:%" \
            "[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|@)+" \
            "(?:/(?:(?:%[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|" \
            "[:@])*)*)|())(?:\\?((?:(?:(?:%[0-9A-Fa-f]{2}|[!$&'()*+" \
            ",;=A-Za-z0-9\\-._~])|[:@])|[/?])*))?(?:#((?:(?:(?:%" \
            "[0-9A-Fa-f]{2}|[!$&'()*+,;=A-Za-z0-9\\-._~])|[:@])|[/?])*))?)$"
EXCLUDED_MACS = [
    'FF:FF:FF:FF:FF:FF',       # Broadcast
    '01:00:0C:CC:CC:CC',       # CISCO discovery protocol
    '01:00:0C:CC:CC:CD',       # CISCO shared spanning tree proto
    '01:80:C2:00:00:00',       # Spanning tree protocol
    '01:80:C2:00:00:00',       # LLDP
    '01:80:C2:00:00:03',       # LLDP
    '01:80:C2:00:00:0E',       # LLDP
    '01:80:C2:00:00:08',       # IEEE 802.1ad
    '01:80:C2:00:00:01',       # IEEE 802.3x
    '01:80:C2:00:00:02',       # IEEE 802.3h
    '01:80:C2:00:00:30',       # IEEE 802.1ag
    '01:80:C2:00:00:3F',       # IEEE 802.1ag
    '01:1B-19-00:00:00',       # Precision Time Protocol
    '01:80:C2:00:00:0E',       # Precision Time Protocol
]
EXCLUDED_MACS_W_WILDCARDS = [
    '01:00:5E',             # IPv4 Multi-cast DNS
    '01:0C:CD:04',          # Multi-cast sampled values
    '01:0C:CD:02',          # GSSE (IEC 61850 8-1)
    '01:0C:CD:01',          # IEC 61850-8-1 GOOSE Type 1/1A
    '33:33',                # IPv6 Multi-cast
    '01:80:C2:00:00:3',     # IEEE 802.1ag
]
DHCP_CLIENT_PORT = 68
DHCP_SERVER_PORT = 67
DHCP_PORTS = [68, 67]
UPNP_PORTS = [1900, 60300]
MDNS_PORTS = [5353, 60301]
HTTP_METHODS = (
    'GET', 'PUT', 'ICY',
    'COPY', 'HEAD', 'LOCK', 'MOVE', 'POLL', 'POST',
    'BCOPY', 'BMOVE', 'MKCOL', 'TRACE', 'LABEL', 'MERGE',
    'DELETE', 'SEARCH', 'UNLOCK', 'REPORT', 'UPDATE', 'NOTIFY',
    'BDELETE', 'CONNECT', 'OPTIONS', 'CHECKIN',
    'PROPFIND', 'CHECKOUT', 'CCM_POST',
    'SUBSCRIBE', 'PROPPATCH', 'BPROPFIND',
    'BPROPPATCH', 'UNCHECKOUT', 'MKACTIVITY',
    'MKWORKSPACE', 'UNSUBSCRIBE', 'RPC_CONNECT',
    'VERSION-CONTROL',
    'BASELINE-CONTROL'
)
